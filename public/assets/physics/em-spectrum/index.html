<!DOCTYPE html>
<html>

<head>
    <title>EM Spectrum</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="description" content="">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- preloader -->
    <script src="https://code.createjs.com/1.0.0/preloadjs.min.js"></script>
    <script type="text/javascript">
        window.scrollTo(0, 1);
    </script>
    <style>
        #loader {
            background-image: url("assets/2d/image/sk-loader.gif");
            background-repeat: no-repeat;
            background-color: #CAE7C1;
            background-attachment: fixed;
            background-position: center;
            width: 100;
            height: 100;
            /*animation: spin 1s linear infinite;*/
        }
        /*@keyframes spin {
            100% {
                transform: rotate(360deg);
            }
        }
        */
        
        .center {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
        }
        
        .a-loader-title {
            color: #FFF;
            background-color: #CAE7C1;
            font-size: 2em;
            font-style: italic;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif
        }
    </style>
</head>

<body>
    <div class="audio">
        <audio src="" id="mainAudio" type="audio/mpeg"></audio>
    </div>
    <div id="loader" class="center">
    </div>
    <a-scene fog="type: exponential; density: 0.1; color: #10454A;" vr-mode-ui="enabled: true" loading-screen="dotsColor: #FFF; backgroundColor: #CAE7C1; enabled:true">

        <a-camera id="default_angle" camera rotation="0 90 0" position="0 1.6 0" look-controls wasd-controls>
            <a-entity id="rig" movement-controls="controls: checkpoint" checkpoint-controls="mode: animate">
                <a-entity id="mouseCursor" cursor="fuse: true; fuseTimeout: 1000" raycaster="objects: .clickable" position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03" material="color: white; shader: flat; opacity: 0.8" event-set__1="_event: mouseenter; color: springgreen"
                    event-set__2="_event: mouseleave; color: white" animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 1000; from: 1 1 1; to: 0.5 0.5 0.5" animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 200; to: 1 1 1"
                    animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 200; to: 1 1 1">
                </a-entity>
        </a-camera>
        <!-- Asset Management -->
        <a-assets>
            <img id="loader-bg" src="assets/2d/bg.png">
            <img id="blur-image-01" src="assets/2d/glow-gradient/Glow02.png">
            <img id="glow-image" src="assets/2d/glow-gradient/Glow02.png">
            <img id="welcome-physics" src="assets/2d/image/welcome-em-2.png">
            <img id="start-learning" src="assets/2d/image/start-learning.png">
            <a-asset-item id="street-lamp-obj" src="assets/3d/street-light/model.gltf"></a-asset-item>
            <a-asset-item id="street-lamp-mtl" src="assets/3d/street-light/materials.mtl"></a-asset-item>
            <a-asset-item id="hologram-glb" src="assets/3d/hologram/hologram.glb"></a-asset-item>
            <a-asset-item id="downhill-glb" src="assets/3d/downhill/downhill.glb"></a-asset-item>
            <a-asset-item id="em-waves-glb" src="assets/3d/em-waves/em-waves-v2.glb"></a-asset-item>
            <img id="gamma-btn" src="assets/2d/image/gamma-btn.png">
            <img id="xray-btn" src="assets/2d/image/xray-btn.png">
            <img id="ultraviolet-btn" src="assets/2d/image/ultraviolet-btn.png">
            <img id="visible-btn" src="assets/2d/image/visible-btn.png">
            <img id="infrared-btn" src="assets/2d/image/infrared-btn.png">
            <img id="microwave-btn" src="assets/2d/image/microwave-btn.png">
            <img id="radiowave-btn" src="assets/2d/image/radiowave-btn.png">

        </a-assets>

        <a-entity id="environment" rotation="0" position="0 0 0">
            <a-entity id="3d" rotation="0" position="0 0 0">
                <a-entity gltf-model="#downhill-glb" scale="0.5 0.5 0.5" rotation="0 90 0" position="0 0 5"></a-entity>

                <a-entity gltf-model="#hologram-glb" scale="0.5 0.5 0.5" position="-0.3 0 -2.5" rotation="0 -45 0"></a-entity>

                <a-entity id="em-waves" gltf-model="" scale="0.2 0.2 0.2" position="-0.4 0.8 -2" rotation="0 -90 0" visible="true" animation-mixer>
                </a-entity>

                <a-entity geometry="primitive: sphere" material="src:#blur-image-01" position="0 100 -100"></a-entity>
            </a-entity>

            <a-entity id="2d" rotation="0" position="0 0 0">
                <a-image src="#glow-image" position="0.1 0.7 -2" rotation="90 0 0" width="2" height="2"></a-image>

                <!--a-entity id="intro" text="font: roboto; value: Electromagnetic waves or EM waves are waves that are created as a result of vibrations between an electric field and a magnetic field." position="-0.5 1.5 -1" rotation="0 30 0" visible="false">
                </a-entity>
                <a-image class="clickable" id="startSimulation" src="#start-learning" width="0.4" height="0.2" position="-0.7 1.3 -0.8" rotation="0 30 0" visible="false"></a-image-->

                <a-curvedimage id="hologram-glow" src="#glow-image" position="0.08 1 -2" theta-length="350" theta-start="90" radius="0.5" visible="false" scale="1 0.5 1"></a-curvedimage>

                <!--Welcome to Physics EM-->
                <a-curvedimage id="mainUI" src="#welcome-physics" position="0.1 1.8 -2" rotation="0 0 0" theta-length="130" theta-start="115" radius="1" visible="true">
                    <a-image class="clickable" id="start" src="#start-learning" position="0 -0.45 -0.8" width="0.8" height="0.2" visible="true" animation="property: scale; to: 1.2 1.2 1.2; dur:2000; easing: linear; loop: true"></a-image>
                    <a-image class="clickable" id="exit" src="" href="" position="0 -0.45 -0.8" width="0.8" height="0.2" visible="false" animation="property: scale; to: 1.2 1.2 1.2; dur:2000; easing: linear; loop: true"></a-image>
                </a-curvedimage>

                <a-entity id="spectrum_panel" rotation="0 " position="0 0 0 " visible="false">
                    <a-entity geometry="primitive:plane " material="color:#00E6FF;" position="0.1 0.6 -1.2 " scale="0.8 0.35 0.5 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="gamma" geometry="primitive:box " material="shader: flat; src: #gamma-btn" position="-0.2 0.65 -1.25" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="x-ray" geometry="primitive:box " material="shader:flat; src: #xray-btn" position="0 0.65 -1.25" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="ultraviolet" geometry="primitive:box " material="shader:flat; src: #ultraviolet-btn" position="0.20 0.65 -1.25" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="visible-light" geometry="primitive:box " material="shader:flat; src: #visible-btn" position="0.4 0.65 -1.25" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="infrared" geometry="primitive:box " material="shader:flat; src: #infrared-btn" position="-0.1 0.60 -1.1" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="microwaves" geometry="primitive:box " material="shader:flat; src: #microwave-btn" position="0.1 0.60 -1.1" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                    <a-entity class="clickable " id="radiowaves" geometry="primitive:box " material="shader:flat; src: #radiowave-btn" position="0.3 0.60 -1.1" scale="0.1 0.06 0.1 " rotation="-60 0 0 "></a-entity>
                </a-entity>
            </a-entity>

            <a-entity id="default-entity ">
                <a-sky color="#ECECEC "></a-sky>
            </a-entity>

            <a-entity id="lighting " rotation="0 " position="0 ">
                <a-entity light="type:directional; intensity:0.6; color:#00E6FF " position="1.4 3.6 -5 "></a-entity>
                <a-entity light="type:point; intensity:0.3; color:#00E6FF " position="1.4 3.6 -5 "></a-entity>
                <a-entity light="type:point; intensity:1; color:#FF1818 " position="1.4 3.6 "></a-entity>
                <a-entity light="type:point; intensity:0.5; color:#FFF "></a-entity>
            </a-entity>
        </a-entity>
    </a-scene>
    <script type="text/javascript">
        //Assets Preloader

        var assetsQueue = new createjs.LoadQueue();

        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/congratulations.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/exit.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/gamma-ray-ui.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/infrared-ui.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/instructions.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/microwaves.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/radiowaves.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/start-learning.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/ultraviolet-ui.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/welcome-em-2.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/image/x-ray.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/glow-gradient/glow1.png");
        assetsQueue.loadFile("/subject/physics/em-spectrum/assets/2d/glow-gradient/Glow02.png");

        document.onreadystatechange = function() {
            if (document.readyState !== "complete") {
                document.querySelector(
                    "body").style.visibility = "hidden";
                document.querySelector(
                    "#loader").style.visibility = "visible";
            } else {
                document.querySelector(
                    "#loader").style.display = "none";
                document.querySelector(
                    "body").style.visibility = "visible";
            }
        };

        //Declaration of variables

        let gammaBtn = document.querySelector('#gamma');
        let xRayBtn = document.querySelector('#x-ray');
        let ultraVioletBtn = document.querySelector('#ultraviolet');
        let visibleLight = document.querySelector('#visible-light');
        let infraredBtn = document.querySelector('#infrared');
        let microWavesBtn = document.querySelector('#microwaves');
        let radioWavesBtn = document.querySelector('#radiowaves');

        let emWavesGLB = document.querySelector('#em-waves');

        const start = document.getElementById("start");

        let mainAudio = document.getElementById("mainAudio");


        var counter = 1;

        window.onload = function() {
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/welcome-em-2.png');
            mainAudio.setAttribute('src', 'assets/audio/1.mp3');
            mainAudio.play();
            mainAudio.loop = false;
        }

        start.addEventListener('click', function() {
            mainAudio.pause();
            document.getElementById("default_angle").setAttribute('position', {
                x: 0,
                y: 1.6,
                z: -0.6
            })
            document.getElementById("spectrum_panel").setAttribute('visible', 'true');
            start.remove();
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/instructions.png');
            document.getElementById("hologram-glow").setAttribute('visible', 'true');
            document.getElementById("em-waves").setAttribute('visible', 'true');

            mainAudio.setAttribute('src', 'assets/audio/2.mp3');
            mainAudio.play();
            mainAudio.loop = false;
        });

        //Need to use data structure called Stack

        gammaBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Gamma-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: -0.5,
                    y: 0.7,
                    z: -2
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/gamma-ray-ui.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/3.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        xRayBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Xray-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: -0.5,
                    y: 0.85,
                    z: -2
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/x-ray.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/4.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        ultraVioletBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Ultraviolet-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: -0.4,
                    y: 0.9,
                    z: -2
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/ultraviolet-ui.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/5.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        visibleLight.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Visible-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: -0.45,
                    y: 0.8,
                    z: -2
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/visible-light-ui.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/6.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        infraredBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Infrared-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: -0.65,
                    y: 0.85,
                    z: -2
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/infrared-ui.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/7.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        microWavesBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Microwaves-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: 0.6,
                    y: 0.9,
                    z: -2
                }),
                emWavesGLB.setAttribute('rotation', {
                    x: 0,
                    y: 90,
                    z: 0
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.2,
                    y: 0.2,
                    z: 0.2
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/microwaves.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/8.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });
        radioWavesBtn.addEventListener('click', function() {
            emWavesGLB.setAttribute('gltf-model', 'assets/3d/em-waves/Radiowaves-final.glb'),
                emWavesGLB.setAttribute('position', {
                    x: 1.3,
                    y: 0.9,
                    z: -2
                }),
                emWavesGLB.setAttribute('rotation', {
                    x: 0,
                    y: 90,
                    z: 0
                }),
                emWavesGLB.setAttribute('scale', {
                    x: 0.3,
                    y: 0.3,
                    z: 0.4
                });
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/radiowaves.png');
            increaseCounter();

            mainAudio.setAttribute('src', 'assets/audio/9.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            console.log(counter);
        });

        //seperate button function for score counter.. make this function work only once
        gammaBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        xRayBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        ultraVioletBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        infraredBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        visibleLight.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        microWavesBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });
        radioWavesBtn.addEventListener('click', function() {
            counter++;
        }, {
            once: true
        });


        ///Counter for the numbers of spectrum interact & show the exit button once its completed.
        function increaseCounter() {

            if (counter >= 7) {
                console.log("Congratulations!");
                setTimeout(showCongratulations, 5000);
            } else {
                console.log("Keep Playing!");
            }
        }

        function showCongratulations() {
            mainAudio.setAttribute('src', 'assets/audio/10.mp3');
            mainAudio.play();
            mainAudio.loop = false;
            document.getElementById("mainUI").setAttribute('src', 'assets/2d/image/congratulations.png');
            document.getElementById("exit").setAttribute('src', 'assets/2d/image/exit.png');
            document.getElementById("exit").setAttribute('visible', 'true');
            //
            document.getElementById("exit").addEventListener('click', function() {
                //Back to Dashboard
                location.href = "/dashboard";
            });
        }


        // Offline Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js').then(function(registration) {
                    // Registration was successful
                    //console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    // registration failed :(
                    //console.log('ServiceWorker registration failed: ', err);
                });
            });
        }

        //declare variables for use in the event listener
        var currentPath = window.location.pathname;
        var cacheButton = document.querySelector('.offline-btn');
        var imageArray = document.querySelector('img');

        //Event listener
        window.addEventListener('offline', () => {
            event.preventDefault();

            var pageResources = [currentPath];
            caches.open('offline-' + currentPath).then(function(cache) {
                var updateCache = cache.addAll(pageResources);

                // Update UI to indicate success
                // Or catch any errors if it doesn't succeed
                updateCache.then(function() {
                    console.log('Article is now available offline.');
                }).catch(function(error) {
                    console.log('Article could not be saved offline.');
                });
            });
        });
    </script>
</body>

</html>